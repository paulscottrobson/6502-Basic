; ************************************************************************************************
; ************************************************************************************************
;
;		Name:		chr.asm
;		Purpose:	Chr$() function
;		Created:	28th February 2021
;		Reviewed: 	8th March 2021
;		Author:		Paul Robson (paul@robsons.org.uk)
;
; ************************************************************************************************
; ************************************************************************************************

		.section code		

; ************************************************************************************************
;
;									make CHR$(Y) at stack A.
;
; ************************************************************************************************

StringChrs:	;; <chrs>		
		tax 								; set up stack
		lda 	#2
		jsr 	AllocateSoftString
		tya
		jsr 	WriteSoftString
StringUpdate:		
		jsr 	ReturnSoftString
		txa
		rts

; ************************************************************************************************
;
;									Null string on stack.
;
; ************************************************************************************************

StringNull:	;; <null>
		tax
		lda 	#1
		jsr 	AllocateSoftString
		jmp 	StringUpdate
		
; ************************************************************************************************
;
;							Put value of current soft string on stack.
;
; ************************************************************************************************

ReturnSoftString:
		lda 	softMemAlloc 				; copy address
		sta 	esInt0,x		
		lda 	softMemAlloc+1
		sta 	esInt1,x				
		lda 	#0 							; zero upper bytes
		sta 	esInt2,x		
		sta 	esInt3,x		
		lda 	#$40 						; type string.
		sta 	esType,x
		rts

		.send 	code

; ************************************************************************************************
;
;									Changes and Updates
;
; ************************************************************************************************
;
;		Date			Notes
;		==== 			=====
;		07-Mar-21 		Pre code read v0.01
;
; ************************************************************************************************
